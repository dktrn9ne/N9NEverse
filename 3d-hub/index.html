<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vite + React</title>
  </head>
  <body>
    <div id="boot" style="position:fixed;inset:0;background:#020308;color:#fff;font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;padding:18px;">
      <div style="max-width:920px;margin:0 auto;">
        <div style="opacity:.7;letter-spacing:.22em;font-size:12px;text-transform:uppercase;">N9NEVERSE</div>
        <h1 style="margin:10px 0 6px;font-size:18px;">Loading 3D Hub…</h1>
        <p style="margin:0;opacity:.8;line-height:1.45;">If this stays stuck, your browser may be blocking WebGL or the app script failed to load.</p>
        <p style="margin:12px 0 0;opacity:.7;font-size:13px;">Try: close Safari completely → reopen → reload.</p>
      </div>
    </div>
    <div id="root"></div>
    <script>
      function showBootError(title, body) {
        var boot = document.getElementById('boot');
        if (!boot) return;
        boot.innerHTML = '<div style="max-width:920px;margin:0 auto;">'
          + '<div style="opacity:.7;letter-spacing:.22em;font-size:12px;text-transform:uppercase;">N9NEVERSE — DIAGNOSTIC</div>'
          + '<h1 style="margin:10px 0 6px;font-size:18px;">' + title + '</h1>'
          + '<pre style="margin-top:14px;padding:14px;border-radius:12px;background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.12);white-space:pre-wrap;word-break:break-word;">'
          + body
          + '</pre>'
          + '</div>';
      }

      // If the main script throws before React mounts, surface the error.
      window.addEventListener('error', function (e) {
        showBootError(
          'Script error while loading.',
          String(e.message || e.error || e) + '\n' + String(e.filename || '') + ':' + String(e.lineno || '')
        );
      });

      window.addEventListener('unhandledrejection', function (e) {
        showBootError('Unhandled promise rejection.', String(e.reason || e));
      });

      // If WebGL never paints, offer a safe fallback mode.
      setTimeout(function(){
        var boot = document.getElementById('boot');
        if (!boot) return;
        if (boot.style.display === 'none') return;
        var inner = boot.querySelector('div');
        if (!inner) return;
        var p = document.createElement('p');
        p.style.margin = '14px 0 0';
        p.style.opacity = '0.85';
        p.style.fontSize = '13px';
        p.textContent = 'Still loading? Tap “Lite Mode” to view the journey without 3D.';
        var a = document.createElement('a');
        a.href = '/?lite=1';
        a.textContent = 'Lite Mode';
        a.style.display = 'inline-flex';
        a.style.marginTop = '10px';
        a.style.padding = '10px 12px';
        a.style.borderRadius = '999px';
        a.style.border = '1px solid rgba(123,231,255,0.22)';
        a.style.background = 'rgba(123,231,255,0.12)';
        a.style.color = 'rgba(255,255,255,0.92)';
        a.style.textDecoration = 'none';
        inner.appendChild(p);
        inner.appendChild(a);
      }, 8000);
    </script>
    <script type="module" src="/src/main.jsx"></script>
  </body>
</html>
